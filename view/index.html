<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ololo</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="https://cdn.socket.io/4.4.1/socket.io.min.js" integrity="sha384-fKnu0iswBIqkjxrhQCTZ7qlLHOFEgNkRmK2vaO/LbTZSXdJfAu6ewRBdwHPhBo/H" crossorigin="anonymous"></script>
</head>
<body>
    ololo
    <div class="container">
        <div id="result">

        </div>
    </div>
<script>
    let template = content => `<div class="dynamic-content">${content}</div>`
    const socket = io.connect('http://127.0.0.1:3004');
    socket.on('start', o => {
        console.log(o);
        $('#result').append(template(o.url));
        socket.emit('lalala', {res: 'ok'});
    });
    socket.on("connect", () => {
        const engine = socket.io.engine;
        console.log(engine.transport.name); // in most cases, prints "polling"

        engine.once("upgrade", () => {
            // called when the transport is upgraded (i.e. from HTTP long-polling to WebSocket)
            console.log(engine.transport.name); // in most cases, prints "websocket"
        });

        engine.on("packet", ({ type, data }) => {
            console.log(type, data)
        });

        engine.on("ololo", ({ type, data }) => {
            console.log('ololo', type, data)
        });

        engine.on("packetCreate", ({ type, data }) => {
            // called for each packet sent
        });

        engine.on("drain", () => {
            // called when the write buffer is drained
        });

        engine.on("close", (reason) => {
            // called when the underlying connection is closed
        });
    });
    console.log(socket)
</script>
</body>
</html>